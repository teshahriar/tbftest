{% extends "base.html" %}

{% block title %}Student Dashboard | {{ student.name }}{% endblock %}

{% block extra_css %}
<style>
    /* Dashboard Layout Constraints */
    .dashboard-wrapper {
        display: flex;
        justify-content: center;
        padding: 10px 0;
    }

    .dashboard-card {
        max-width: 750px; /* Fixed professional width */
        width: 100%;
        height: fit-content; /* Hugs content tightly */
    }

    /* Status Bar */
    .status-bar {
        margin: -25px -25px 20px -25px;
        padding: 10px;
        text-align: center;
        font-size: 0.8rem;
        font-weight: 800;
        text-transform: uppercase;
        border-radius: 8px 8px 0 0;
    }
    .verified { background: #28a745; color: white; }
    .pending { background: var(--gold); color: var(--navy); }

    /* Profile Section */
    .profile-box {
        display: flex;
        gap: 25px;
        align-items: center;
        padding-bottom: 20px;
        border-bottom: 1px solid #edf2f7;
    }

    .profile-photo {
        width: 130px;
        height: 130px;
        border-radius: 6px;
        object-fit: cover;
        border: 2px solid var(--navy);
        flex-shrink: 0;
    }

    .student-details h1 {
        font-size: 1.6rem;
        color: var(--navy);
        margin-bottom: 4px;
        line-height: 1.2;
    }

    .student-details p {
        font-size: 0.95rem;
        color: #4a5568;
        margin: 2px 0;
    }

    /* Professional Button Component */
    .btn-action {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 24px;
        font-size: 0.85rem;
        font-weight: 700;
        text-decoration: none;
        text-transform: uppercase;
        border-radius: 4px;
        transition: all 0.2s ease;
        border: none;
        cursor: pointer;
        width: fit-content;
        margin-top: 10px;
    }

    .btn-download {
        background-color: #28a745;
        color: white;
        box-shadow: 0 3px 0 #1e7e34;
    }

    .btn-download:hover {
        background-color: #218838;
        transform: translateY(-1px);
    }

    .btn-submit {
        background-color: var(--gold);
        color: var(--navy);
        box-shadow: 0 3px 0 #d4aa00;
    }

    /* Form Styling */
    .verification-area {
        padding-top: 20px;
    }

    .input-group {
        display: flex;
        gap: 10px;
        margin-top: 10px;
        max-width: 450px;
    }

    .input-field {
        flex: 1;
        padding: 10px;
        border: 1px solid #cbd5e0;
        border-radius: 4px;
        font-size: 0.9rem;
    }

    @media (max-width: 600px) {
        .profile-box { flex-direction: column; text-align: center; }
        .input-group { flex-direction: column; }
        .btn-action { width: 100%; }
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-wrapper">
    <div class="card dashboard-card">
        
        {% if is_verified %}
            <div class="status-bar verified">✓ Verified Student Status</div>
        {% else %}
            <div class="status-bar pending">⚠ Verification Pending</div>
        {% endif %}

        <div class="profile-box">
            <img src="{{ url_for('static', filename='uploads/' + student.photo) }}" alt="Student Photo" class="profile-photo">
            <div class="student-details">
                <h1>{{ student.name }}</h1>
                <p><strong>Roll No:</strong> {{ student.roll_no }}</p>
                <p><strong>Registration:</strong> {{ student.reg_no }}</p>
                <p><strong>Academic Class:</strong> {{ student.class }}</p>
            </div>
        </div>

        <div class="verification-area">
            {% if is_verified %}
                <div style="text-align: center;">
                    <p style="color: #2d3748; margin-bottom: 15px;">Your admission is confirmed. Please download your payment slip for future reference.</p>
                    <a href="/download-slip" class="btn-action btn-download">
                        <span style="margin-right: 8px;">⬇</span> Download Pay Slip (PDF)
                    </a>
                </div>
            {% else %}
                <h3 style="font-size: 1.1rem; color: var(--navy);">Transaction Verification</h3>
                <p style="font-size: 0.85rem; color: #718096;">Enter the SSLCommerz Transaction ID to verify your admission payment.</p>
                
                <form method="POST" class="input-group">
                    <input type="text" name="tran_id" class="input-field" 
                           placeholder="Enter Transaction ID" 
                           value="{{ student.tran_id or '' }}" required>
                    <button type="submit" class="btn-action btn-submit" style="margin-top:0;">Update ID</button>
                </form>

                {% if student.tran_id %}
                    <div style="margin-top: 15px; padding: 12px; background: #fffaf0; border-left: 4px solid var(--gold); border-radius: 4px;">
                        <span style="font-size: 0.8rem; font-weight: 700; color: #744210;">ID SUBMITTED:</span> 
                        <code style="display: block; font-size: 0.9rem; margin-top: 4px;">{{ student.tran_id }}</code>
                        <p style="font-size: 0.75rem; color: #975a16; margin-top: 5px;">Our administration is currently reviewing this transaction. Please check back within 24 hours.</p>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
