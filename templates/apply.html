{% extends "base.html" %}
{% block content %}
<style>
    :root { 
        --navy: #1B2631; --paper-white: #FFFFFF; --accent-crimson: #922B21; 
        --border-gold: #D4AC0D; --bg-soft: #F4F6F7; --input-border: #ABB2B9;
    }
    
    body { background-color: var(--bg-soft); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }

    .form-container { 
        max-width: 1000px; margin: 20px auto; background: var(--paper-white); 
        border: 1px solid var(--input-border); box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        border-radius: 8px; overflow: hidden;
    }

    .form-banner { background: var(--navy); color: white; padding: 25px 15px; text-align: center; border-bottom: 4px solid var(--accent-crimson); }
    .form-banner h2 { margin: 0; font-size: clamp(1.2rem, 5vw, 1.6rem); text-transform: uppercase; }
    
    .form-content { padding: clamp(15px, 4vw, 30px); }

    /* Responsive Grid System */
    .grid-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 15px; }

    .field-box { 
        display: flex; border: 1px solid var(--input-border); background: #fff; 
        min-height: 45px; transition: all 0.3s;
    }
    .field-box:focus-within { border-color: var(--navy); box-shadow: 0 0 5px rgba(27, 38, 49, 0.2); }
    
    .field-box label { 
        background: var(--navy); color: #fff; padding: 0 12px; min-width: 140px; 
        display: flex; align-items: center; font-size: 11px; font-weight: 600; text-transform: uppercase;
    }
    .field-box input, .field-box select { flex: 1; border: none; padding: 10px; outline: none; font-size: 14px; width: 100%; }

    .section-title { 
        background: #EBEDEF; color: var(--navy); padding: 12px 15px; font-weight: 700; font-size: 13px;
        text-transform: uppercase; border-left: 5px solid var(--accent-crimson); margin: 30px 0 15px;
        display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;
    }

    /* Address Checkbox Styling */
    .copy-label { font-size: 11px; text-transform: none; color: #555; font-weight: normal; cursor: pointer; display: flex; align-items: center; gap: 5px; }

    /* Upload Section Responsive */
    .upload-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .upload-box { 
        background: #fff; border: 2px dashed var(--input-border); padding: 20px; 
        text-align: center; cursor: pointer; border-radius: 5px; transition: 0.3s;
    }
    .upload-box:hover { border-color: var(--accent-crimson); background: #fdf2f2; }

    .btn-submit { 
        background: var(--accent-crimson); color: white; padding: 15px 50px; border: none; 
        font-weight: 700; border-radius: 5px; cursor: pointer; width: 100%; max-width: 300px;
        text-transform: uppercase; transition: 0.3s; display: block; margin: 40px 0 0 auto;
    }
    .btn-submit:hover { background: var(--navy); transform: translateY(-2px); }

    @media (max-width: 600px) {
        .field-box { flex-direction: column; }
        .field-box label { padding: 8px 12px; min-width: 100%; }
        .btn-submit { max-width: 100%; }
    }
</style>

<div class="form-container">
    <div class="form-banner">
        <h2>Scholarship Registration Form - 2026</h2>
        <p>The Brilliants Foundation, Bogura</p>
    </div>

    <form action="{{ url_for('apply') }}" method="POST" enctype="multipart/form-data" id="applyForm" class="form-content">
        
        <div class="grid-row">
            <div class="field-box">
                <label>Academic Class</label>
                <select name="student_class" id="classSelector" required onchange="handleClassChange()">
                    <option value="" disabled selected>Select Class</option>
                    <option value="5">Class 5</option>
                    <option value="8">Class 8</option>
                    <option value="9">Class 9</option>
                    <option value="10">Class 10</option>
                </select>
            </div>
            <div class="field-box">
                <label>Examination Center</label>
                <select name="center_code" id="centerSelector" required>
                    <option value="">Choose Class First</option>
                </select>
            </div>
        </div>

        <div class="section-title">Personal Information</div>
        <div class="grid-row">
            <div class="field-box"><label>Name (English)</label><input type="text" name="name_en" required></div>
            <div class="field-box"><label>শিক্ষার্থীর নাম (বাংলা)</label><input type="text" name="name_bn"></div>
        </div>
        <div class="grid-row">
            <div class="field-box"><label>Father (English)</label><input type="text" name="father_en" required></div>
            <div class="field-box"><label>Father (Bangla)</label><input type="text" name="father_bn"></div>
        </div>
        <div class="grid-row">
            <div class="field-box"><label>Mobile Number</label><input type="tel" name="mobile" required placeholder="017XXXXXXXX"></div>
            <div class="field-box"><label>Date of Birth</label><input type="date" name="dob" required></div>
        </div>

        <div class="grid-row">
            <div>
                <div class="section-title">Present Address</div>
                <div class="field-box"><label>Village/House</label><input type="text" name="pre_v" id="pre_v" required></div>
                <div class="field-box"><label>Post Office</label><input type="text" name="pre_p" id="pre_p" required></div>
                <div class="field-box"><label>Upazila</label><input type="text" name="pre_t" id="pre_t" required></div>
                <div class="field-box"><label>District</label><input type="text" name="pre_d" id="pre_d" required></div>
            </div>

            <div>
                <div class="section-title">
                    Permanent Address
                    <label class="copy-label"><input type="checkbox" id="copyCheck" onclick="copyAddress(this)"> Same as Present</label>
                </div>
                <div class="field-box"><label>Village/House</label><input type="text" name="per_v" id="per_v" required></div>
                <div class="field-box"><label>Post Office</label><input type="text" name="per_p" id="per_p" required></div>
                <div class="field-box"><label>Upazila</label><input type="text" name="per_t" id="per_t" required></div>
                <div class="field-box"><label>District</label><input type="text" name="per_d" id="per_d" required></div>
            </div>
        </div>

        <div class="section-title">Account Security</div>
        <div class="grid-row">
            <div class="field-box"><label>Password</label><input type="password" name="password" required></div>
            <div class="field-box"><label>Confirm</label><input type="password" name="confirm_password" required></div>
        </div>

        <div class="section-title">Photo & Signature Upload</div>
        <div class="upload-grid">
            <label class="upload-box" id="pLabel">
                <strong>PHOTO (300x350)</strong>
                <input type="file" name="photo" id="photoInput" required style="display:block; margin: 10px auto;" onchange="validateImg(this, 300, 350, 'pLabel')">
            </label>
            <label class="upload-box" id="sLabel">
                <strong>SIGNATURE (300x80)</strong>
                <input type="file" name="signature" id="signInput" required style="display:block; margin: 10px auto;" onchange="validateImg(this, 300, 80, 'sLabel')">
            </label>
        </div>

        <button type="submit" class="btn-submit">Submit Application</button>
    </form>
</div>



<script>
    function handleClassChange() {
        const cls = document.getElementById('classSelector').value;
        const center = document.getElementById('centerSelector');
        center.innerHTML = '<option value="">Select Center Code</option>';
        let list = (cls === "5" || cls === "8") ? ["C-101", "C-102"] : ["C-201", "C-202"];
        list.forEach(item => {
            let opt = document.createElement('option');
            opt.value = item; opt.innerText = item;
            center.appendChild(opt);
        });
    }

    function copyAddress(cb) {
        const fields = ['v', 'p', 't', 'd'];
        fields.forEach(f => {
            document.getElementById('per_' + f).value = cb.checked ? document.getElementById('pre_' + f).value : "";
        });
    }

    function validateImg(input, w, h, labelId) {
        const file = input.files[0];
        if(!file) return;
        const img = new Image();
        img.src = URL.createObjectURL(file);
        img.onload = function() {
            const box = document.getElementById(labelId);
            if(this.width !== w || this.height !== h) {
                alert(`Warning: Image size should be ${w}x${h}. Current: ${this.width}x${this.height}`);
                box.style.borderColor = "orange";
            } else {
                box.style.background = "#E8F8F5";
                box.style.borderColor = "#1ABC9C";
            }
        };
    }
</script>
{% endblock %}